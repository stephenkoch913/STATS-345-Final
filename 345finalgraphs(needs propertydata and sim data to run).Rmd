---
title: "Test for R final Project"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown


Expected Submission: You will generate a well-written R Markdown report that addresses the following prompts. This R Markdown report should source your analysis code and only display top-level, abstracted code _if/when appropriate_. Choices made during the analysis project should be described and justified in the report. You will present on your results during the final exam period for the semester. The written report (knitted file), presentation file, and your analysis code should be submitted to D2L by Tuesday, May 14 at 12:15pm. 

**General advice:** Get started early. If you wait to the last minute, it will not go well. For this project, you may find yourself spending a reasonable amount of time _searching_ for help.

1. _Rules!_ Monopoly has several rules related to movement around the game board. Movement is affected by standard dice rolls, special conditions for some dice rolls, and game cards. Find and summarize these rules. 

2. _Let's Get Moving_ Build a system that allows for up to 4 players to move around the game board. As a first attempt, focus on standard dice rolls, ignoring additional rules related to rolling doubles, jail, or special cards. Which properties are landed on most frequently? Create a visualization for this!

3. _Double Down_ Improve your system to incorporate going to jail, including the doubles-rolling condition. Which properties are landed on most frequently now? Has this changed dramatically from the previous system (that didn't account for jail)? Again, visualize this!

4. _Take a Chance_ Incorporate the movement cards into your system. You can ignore the effects of non-movement cards, but not their existence! Which properties are landed on most frequently now? Has this changed dramatically from the previous system (that didn't account for Chance)? Again, visualize this!

5. _Play a Game_ Extend your system to allow for up to 4 players to "play" the game. You may choose a reasonable starting board and player money level (so, you don't have to buy properties). Include payments between players, payments to the bank, and payments from the bank (there are several cards that will effect these that you should account for). You do not need to consider mortgaging properties (so a player loses when their liquid cash has run out). How long do games typically last given your starting board and money level? How does this change if money paid to the bank is placed in "Free Parking" and awarded to players landing on that space?

```{r, include = FALSE}
library(tidyverse)
```



```{r, message=FALSE}
sim_data <- tibble(read.csv("monopolysimdata.csv"))
prop_data <- tibble(read.csv("monopolypropertydata.csv"))


m_data <- inner_join(sim_data, prop_data, by = "space")
just_prop <- m_data %>% drop_na(Hotel)

just_prop <- just_prop %>% mutate(expected_payment_base = rel*No_House_Doubled, expected_payment_one_house = rel*One_House, expected_payment_two_houses = rel*Two_Houses, expected_payment_three_houses = rel*Three_Houses, expected_payment_four_houses = rel*Four_Houses, expected_payment_hotel = rel*Hotel)

just_prop <- just_prop %>% mutate(hotel_cost_total = 5* House_Cost + Sale_Cost, four_houses_cost_total = 4* House_Cost + Sale_Cost, three_houses_cost_total = 3* House_Cost + Sale_Cost, two_houses_cost_total = 2* House_Cost + Sale_Cost, one_house_cost_total =  House_Cost + Sale_Cost)

just_prop <- just_prop %>% mutate(expected_turns_to_repay_hotel = hotel_cost_total/expected_payment_hotel, expected_turns_to_repay_four_houses = four_houses_cost_total/expected_payment_four_houses, expected_turns_to_repay_three_houses = three_houses_cost_total/ expected_payment_three_houses, expected_turns_to_repay_two_houses = two_houses_cost_total/expected_payment_two_houses, expected_turns_to_repay_one_house = one_house_cost_total/expected_payment_one_house, expected_turns_to_repay_base = Sale_Cost/expected_payment_base)
```

```{r, message=FALSE}
ggplot(data = just_prop, aes(x = Sale_Cost, y = expected_payment_base, size = 2)) + geom_point(aes(color = Identifier)) + geom_smooth(method = lm, se = FALSE, size =1, color = "black")+ scale_color_manual(values = c("blue","brown", "green3", "light blue", "orange", "purple", "red","yellow3")) + theme_bw() + labs(title = "Cost of Property vs Expected Payment per turn No Houses", x = "Cost of Property", y = "Expected Payment per turn")
```




```{r, message=FALSE}
ggplot(data = just_prop, aes(x = hotel_cost_total, y = expected_payment_hotel,  size = 2)) + geom_point(aes(color = Identifier)) + geom_smooth(method = lm, se = FALSE, size =1, color = "black") + scale_color_manual(values = c("blue","brown", "green3", "light blue", "orange", "purple", "red","yellow3")) + theme_bw() +labs(title = "Total Cost of Hotel and Property vs Expected Payment per Turn with Hotels", x = "Total Cost of Hotel and Property", y = "Expected Payment per Turn with Hotels")

```

```{r, message=FALSE}
ggplot(data = just_prop, aes(x = hotel_cost_total, y = expected_turns_to_repay_hotel,  size = 2)) + geom_point(aes(color = Identifier)) + geom_smooth(method = lm, se = FALSE, size =1, color = "black") + scale_color_manual(values = c("blue","brown", "green3", "light blue", "orange", "purple", "red","yellow3")) + theme_bw() + labs(title = "Total Cost vs Expected Turns to Break Even With Hotels", x = "Total Cost of Property and Hotel", y = "Expected Turns to Break Even With Hotels")
```

```{r, message=FALSE}
ggplot(data = just_prop, aes(x = four_houses_cost_total, y = expected_turns_to_repay_four_houses,  size = 2)) + geom_point(aes(color = Identifier)) + geom_smooth(method = lm, se = FALSE, size =1, color = "black") + scale_color_manual(values = c("blue","brown", "green3", "light blue", "orange", "purple", "red","yellow3")) + theme_bw() + labs(title = "Total Cost vs Expected Turns to Break Even With Four Houses", x = "Total Cost of Property and Four Houses", y = "Expected Turns to Break Even With Four Houses")
```

```{r, message=FALSE}
ggplot(data = just_prop, aes(x = three_houses_cost_total, y = expected_turns_to_repay_three_houses,  size = 2)) + geom_point(aes(color = Identifier)) + geom_smooth(method = lm, se = FALSE, size =1, color = "black") + scale_color_manual(values = c("blue","brown", "green3", "light blue", "orange", "purple", "red","yellow3")) + theme_bw() + labs(title = "Total Cost vs Expected Turns to Break Even With Three Houses", x = "Total Cost of Property and Three Houses", y = "Expected Turns to Break Even With Three Houses")
```

```{r, message=FALSE}
ggplot(data = just_prop, aes(x = two_houses_cost_total, y = expected_turns_to_repay_two_houses,  size = 2)) + geom_point(aes(color = Identifier)) + geom_smooth(method = lm, se = FALSE, size =1, color = "black") + scale_color_manual(values = c("blue","brown", "green3", "light blue", "orange", "purple", "red","yellow3")) + theme_bw() + labs(title = "Total Cost vs Expected Turns to Break Even With Two Houses", x = "Total Cost of Property and Two Houses", y = "Expected Turns to Break Even With Two Houses")
```

```{r, message=FALSE}
ggplot(data = just_prop, aes(x = one_house_cost_total, y = expected_turns_to_repay_one_house,  size = 2)) + geom_point(aes(color = Identifier)) + geom_smooth(method = lm, se = FALSE, size =1, color = "black") + scale_color_manual(values = c("blue","brown", "green3", "light blue", "orange", "purple", "red","yellow3")) + theme_bw() + labs(title = "Total Cost vs Expected Turns to Break Even With One House", x = "Total Cost of Property and One House", y = "Expected Turns to Break Even With One House")
```

```{r, message=FALSE}
ggplot(data = just_prop, aes(x = Sale_Cost, y = expected_turns_to_repay_base,  size = 2)) + geom_point(aes(color = Identifier)) + geom_smooth(method = lm, se = FALSE, size =1, color = "black") + scale_color_manual(values = c("blue","brown", "green3", "light blue", "orange", "purple", "red","yellow3")) + theme_bw() + labs(title = "Cost of Property vs Expected Turns to Break Even With No Houses", x = "Cost of Property", y = "Expected Turns to Break Even With No Houses")
```
```{r, message=FALSE}
just_prop <- just_prop %>% mutate(mean_turns_to_break_even = (expected_turns_to_repay_base + expected_turns_to_repay_one_house + expected_turns_to_repay_two_houses + expected_turns_to_repay_three_houses + expected_turns_to_repay_four_houses + expected_turns_to_repay_hotel) / 6 )

ggplot(data = just_prop, aes(x = Sale_Cost, y = mean_turns_to_break_even,  size = 2)) + geom_point(aes(color = Identifier)) + geom_smooth(method = lm, se = FALSE, size =1, color = "black") + scale_color_manual(values = c("blue","brown", "green3", "light blue", "orange", "purple", "red","yellow3")) + theme_bw() + labs(title = "Cost of Property vs Mean Turns to Break Even", x = "Cost of Property", y = "Mean Turns to Break Even")
```
```{r}
just_prop %>% select(space, title, Identifier, Sale_Cost, mean_turns_to_break_even) %>% arrange(mean_turns_to_break_even)
```

```{r}
just_prop %>% select(space, title, Identifier, Sale_Cost, mean_turns_to_break_even) %>% group_by(Identifier) %>% summarize(color_mean_turns_to_break_even = mean(mean_turns_to_break_even)) %>% arrange(color_mean_turns_to_break_even)
```

